<!-- Shared navbar + off-canvas menu -->
<header class="bg-green-900 text-white">
  <div class="max-w-7xl m-auto px-6 py-6">
    <div class="flex items-center justify-between relative">
      {% if request.endpoint == 'profile' %}
      <div class="flex items-center gap-6">
        <img src="{{ url_for('static', filename='images/momcare_logo_white.png') }}" alt="MomCare"
          class="h-20 w-auto" />
        <div>
          <h1 class="text-l lg:text-xl font-bold">My Account</h1>
          <p class="mt-1 text-sm opacity-90">Today: <span id="currentDateDisplay">{{ today or ''
              }}</span></p>
        </div>
      </div>
      {% elif request.endpoint == 'mood' %}
      <div class="flex items-center gap-6">
        <img src="{{ url_for('static', filename='images/momcare_logo_white.png') }}" alt="MomCare"
          class="h-20 w-auto" />
        <div>
          <h1 class="text-l lg:text-xl font-bold">Mood & Wellness</h1>
          <p class="mt-1 text-sm opacity-90">Today: <span id="currentDateDisplay">{{ today or ''
              }}</span></p>
        </div>
      </div>
      {% elif request.endpoint == 'budgetexpenses' %}
      <div class="flex items-center gap-6">
        <img src="{{ url_for('static', filename='images/momcare_logo_white.png') }}" alt="MomCare"
          class="h-20 w-auto" />
        <div>
          <h1 class="text-l lg:text-xl font-bold">Budget & Expenses</h1>
          <p class="mt-1 text-sm opacity-90">Today: <span id="currentDateDisplay">{{ today or '' }}</span></p>
        </div>
      </div>
      {% elif request.endpoint == 'tasks' %}
      <div class="flex items-center gap-6">
        <img src="{{ url_for('static', filename='images/momcare_logo_white.png') }}" alt="MomCare"
          class="h-20 w-auto" />
        <div>
          <h1 class="text-l lg:text-xl font-bold">Daily Tasks</h1>
          <p class="mt-1 text-sm opacity-90">Today: <span id="currentDateDisplay">{{ today or ''
              }}</span></p>
        </div>
      </div>
      {% else %}
      <div class="flex items-center gap-6">
        <img src="{{ url_for('static', filename='images/momcare_logo_white.png') }}" alt="MomCare"
          class="h-20 w-auto" />
        <div>
          <h1 class="text-l lg:text-xl font-bold">How are you today, {{ first or session.get('user_first') or
            'User' }}?</h1>
          <p class="mt-1 text-sm opacity-90">Today: <span id="currentDateDisplay">{{ today or ''
              }}</span></p>
        </div>
      </div>
      {% endif %}

      <!-- Right Side Grouping: Picker + Menu Toggle -->
      <div class="flex items-center gap-2 md:gap-4">



        <button id="menu-toggle" class="p-3 md:p-2 rounded-md focus:outline-none" aria-label="Open menu"
          aria-expanded="false" aria-controls="menu-list">
          <svg class="h-8 w-8 text-[#ffcc48]" xmlns="http://www.w3.org/2000/svg" fill="currentColor"
            viewBox="0 0 24 24">
            <path d="M3 6h18v2H3zM3 11h18v2H3zM3 16h18v2H3z" />
          </svg>
        </button>

      </div>

      <!-- Overlay for off-canvas menu -->
      <div id="overlay" class="fixed inset-0 bg-black bg-opacity-40 hidden z-40"></div>

      <!-- Off-canvas side menu -->
      <aside id="side-menu"
        class="fixed top-0 right-0 h-full w-80 bg-white text-green-900 transform translate-x-full transition-transform duration-300 z-50 shadow-lg"
        aria-hidden="true">
        <div class="flex items-center justify-between px-4 py-4 border-b">
          <div class="flex items-center gap-3">
            <img class="h-10 w-auto" src="{{ url_for('static', filename='images/momcare_logo_colored.png') }}"
              alt="MomCare" />
          </div>
          <button id="side-close" aria-label="Close menu" class="p-2 rounded hover:bg-gray-100">
            <svg class="h-6 w-6 text-green-800" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"
              stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>

        <nav class="px-4 py-6 space-y-2">
          <a href="{{ url_for('my_account') }}" class="flex items-center gap-3 px-3 py-2 rounded hover:bg-green-50">
            <i class="fas fa-user text-green-900"></i><span>My Account</span>
          </a>
          <a href="{{ url_for('dashboard') }}" class="flex items-center gap-3 px-3 py-2 rounded hover:bg-green-50">
            <i class="fas fa-chart-line text-green-900"></i><span>Dashboard</span>
          </a>
          <a href="{{ url_for('tasks') }}" class="flex items-center gap-3 px-3 py-2 rounded hover:bg-green-50">
            <i class="fas fa-tasks text-green-900"></i><span>Daily Tasks</span>
          </a>
          <a href="{{ url_for('budgetexpenses') }}" class="flex items-center gap-3 px-3 py-2 rounded hover:bg-green-50">
            <i class="fas fa-wallet text-green-900"></i><span>Budget & Expenses</span>
          </a>
          <a href="{{ url_for('mood') }}" class="flex items-center gap-3 px-3 py-2 rounded hover:bg-green-50">
            <i class="fas fa-heart text-green-900"></i><span>Mood & Wellness</span>
          </a>
          <a href="#" onclick="confirmLogout(event)"
            class="flex items-center gap-3 px-3 py-2 rounded hover:bg-green-50">
            <i class="fas fa-sign-out-alt text-green-900"></i><span>Sign out</span>
          </a>
        </nav>
      </aside>

    </div>
  </div>
</header>

<!-- pale blue separator bar shown under header (profile style) -->
<div class="h-3 bg-[#c9eef2]"></div>

<script>
  // Off-canvas menu behavior
  const toggle = document.getElementById('menu-toggle');
  const sideMenu = document.getElementById('side-menu');
  const overlay = document.getElementById('overlay');
  const sideClose = document.getElementById('side-close');

  function openSideMenu() {
    sideMenu.classList.remove('translate-x-full');
    sideMenu.setAttribute('aria-hidden', 'false');
    overlay.classList.remove('hidden');
    toggle.setAttribute('aria-expanded', 'true');
  }

  function closeSideMenu() {
    sideMenu.classList.add('translate-x-full');
    sideMenu.setAttribute('aria-hidden', 'true');
    overlay.classList.add('hidden');
    toggle.setAttribute('aria-expanded', 'false');
  }

  if (toggle && sideMenu && overlay) {
    toggle.addEventListener('click', (e) => {
      e.stopPropagation();
      if (sideMenu.classList.contains('translate-x-full')) openSideMenu();
      else closeSideMenu();
    });

    if (sideClose) sideClose.addEventListener('click', closeSideMenu);
    overlay.addEventListener('click', closeSideMenu);

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') closeSideMenu();
    });
  }

  // Logout confirmation with custom modal
  function confirmLogout(event) {
    event.preventDefault();
    document.getElementById('logoutModal').classList.remove('hidden');
  }

  function closeLogoutModal() {
    document.getElementById('logoutModal').classList.add('hidden');
  }

  function proceedLogout() {
    window.location.href = "{{ url_for('logout') }}";
  }

</script>

<!-- Logout Confirmation Modal -->
<div id="logoutModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-[60] hidden">
  <div class="bg-white rounded-2xl p-8 w-96 shadow-2xl text-center transform transition-all">
    <div class="mb-4">
      <div class="mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center">
        <i class="fas fa-sign-out-alt text-orange-600 text-3xl"></i>
      </div>
    </div>
    <h3 class="text-2xl font-bold text-[#104b0b] mb-2">Sign Out?</h3>
    <p class="text-gray-600 mb-6">Are you sure you want to sign out?</p>
    <div class="flex gap-3">
      <button onclick="closeLogoutModal()"
        class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-xl font-semibold hover:bg-gray-300 transition-colors">
        Cancel
      </button>
      <button onclick="proceedLogout()"
        class="flex-1 bg-red-600 text-white py-3 rounded-xl font-semibold hover:bg-red-700 transition-colors">
        Sign Out
      </button>
    </div>
  </div>
</div>